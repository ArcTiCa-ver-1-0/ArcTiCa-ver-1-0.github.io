!function WP$UI$LocaleSwitcherController$definition(){var o=function WP$UI$LocaleSwitcherController(o){this.WP$Controllers$Controller(),this.proxify("_localeButtonKeyDown","_localeButtonClick","_openLocaleDropdown","_closeLocaleDropdown","_setFocusToMenuButton"),this.proxify("_setFocusToFirstLink","_setFocusToLastLink","_setFocusToNextLink","_setFocusToPreviousLink","_localeLinkKeyDown"),this.proxify("_localeLinkClick"),this.$root=o,this.$menuButton=this.$root.find("button#localeswitch"),this.$links=this.$root.find(".morelocalesitemlink"),this.$currentLocaleLink=this.$root.find("#currentlanguagelink"),this.$firstLink=this.$links.first(),this.$lastLink=this.$links.last(),this.$localesList=this.$root.find("#morelocalesnav"),this.numLinks=this.$links.length,this.currentIndex=0,this.keyCode={TAB:9,RETURN:13,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40},this.$root.on("blur",this._closeLocaleDropdown),this.$menuButton.on("keydown",this._localeButtonKeyDown),this.$menuButton.on("click",this._localeButtonClick),this.$links.on("keydown",this._localeLinkKeyDown),this.$currentLocaleLink.on("click",this._closeLocaleDropdown),this.$links.on("click",this._localeLinkClick)};o.prototype={$root:null,$menuButton:null,$links:null,$firstLink:null,$lastLink:null,$localesList:null,currentIndex:0,_localeButtonKeyDown:function WP$UI$LocaleSwitcherController$_localeButtonKeyDown(o){var e=!0;switch(o.keyCode){case this.keyCode.SPACE:case this.keyCode.RETURN:this._openLocaleDropdown(),this._setFocusToFirstLink();break;default:e=!1}e&&(o.stopPropagation(),o.preventDefault())},_localeButtonClick:function WP$UI$LocaleSwitcherController$_localeButtonClick(o){"true"===this.$menuButton.safeAttr("aria-expanded")?this._closeLocaleDropdown(!0):(this._openLocaleDropdown(),this._setFocusToFirstLink()),o.stopPropagation(),o.preventDefault()},_localeLinkClick:function WP$UI$LocaleSwitcherController$_localeLinkClick(o){var e=$afe.jq(o.target);if("currentlanguagelink"!==e.safeAttr("id")){var t="";if(WP.DOM.Browser.isIE){var s;if(-1!==(t=document.location.href).indexOf("?")&&(s=t.substring(t.indexOf("?")+1).split("&")),t=document.location.pathname,s&&s.length>0)for(var i=0;i<s.length;i++)s[i]=s[i].split("="),s[i][0]&&"lang"!==s[i][0].toLowerCase()&&(void 0===s[i][1]&&(s[i][1]=""),t=addQueryStringToUrl(t,s[i][0],s[i][1]));t=addQueryStringToUrl(t,"lang",e.safeAttr("lang"))}else{var n=new URLSearchParams(document.location.search);n.set("lang",e.safeAttr("lang")),t=document.location.pathname+"?"+n.toString()}return $$WP.Utilities.TryRedirect(t),!1}return!0},_openLocaleDropdown:function WP$UI$LocaleSwitcherController$_openProxyDropdown(){this.$localesList.removeClass("localeHide").removeClass("jqHidden").addClass("localeShow").safeAttr("aria-hidden","false"),this.$menuButton.safeAttr("aria-expanded","true");var o=$afe.select("body");o.css("margin-top",-$$WPUtil.getScrollTop()),o.on("click",this._closeLocaleDropdown),this.$localesList.scrollTop=0},_closeLocaleDropdown:function WP$UI$LocaleSwitcherController$_closeLocaleDropdown(o){this.$menuButton.safeAttr("aria-expanded","false"),this.$localesList.removeClass("localeShow").addClass("localeHide").addClass("jqHidden").safeAttr("aria-hidden","true"),o||this._setFocusToMenuButton();var e=$afe.select("body"),t=-parseInt(e.css("margin-top"));e.css("margin-top",""),$$WPUtil.setScrollTop(t),e.off("click",this._closeLocaleDropdown)},_setFocusToMenuButton:function WP$UI$LocaleSwitcherController$_setFocusToMenuButton(){this.$menuButton.focus()},_setFocusToFirstLink:function WP$UI$LocaleSwitcherController$_setFocusToFirstLink(){this.$firstLink.focus(),this.currentIndex=0},_setFocusToLastLink:function WP$UI$LocaleSwitcherController$_setFocusToLastLink(){this.$lastLink.focus(),this.currentIndex=this.numLinks-1},_setFocusToPreviousLink:function WP$UI$LocaleSwitcherController$_setFocusToPreviousLink(o){return this.currentIndex<=0?o?(this._setFocusToLastLink(),!1):(this._closeLocaleDropdown(),!0):(this.$links.eq(--this.currentIndex).focus(),!1)},_setFocusToNextLink:function WP$UI$LocaleSwitcherController$_setFocusToNextLink(o){return this.currentIndex>=this.$links.length-1?o?(this._setFocusToFirstLink(),!1):(this._closeLocaleDropdown(),!0):(this.$links.eq(++this.currentIndex).focus(),!1)},_localeLinkKeyDown:function(o){var e=!1;if(!(o.ctrlKey||o.altKey||o.metaKey)){if(o.shiftKey)o.keyCode===this.keyCode.TAB&&(e=!this._setFocusToPreviousLink(!1));else switch(e=!0,o.keyCode){case this.keyCode.ESC:this._closeLocaleDropdown();break;case this.keyCode.SPACE:this._localeLinkClick(o);break;case this.keyCode.UP:this._setFocusToPreviousLink(!0);break;case this.keyCode.DOWN:this._setFocusToNextLink(!0);break;case this.keyCode.TAB:e=!this._setFocusToNextLink(!1);break;case this.keyCode.HOME:case this.keyCode.PAGEUP:this._setFocusToFirstLink();break;case this.keyCode.END:case this.keyCode.PAGEDOWN:this._setFocusToLastLink();break;default:e=!1}e&&(o.stopPropagation(),o.preventDefault())}}},$$WP.UI=$$WP.UI||{},$$WP.UI.LocaleSwitcherController=o,o.extend($$WP.Controllers.Controller,"WP$UI$LocaleSwitcherController")}();