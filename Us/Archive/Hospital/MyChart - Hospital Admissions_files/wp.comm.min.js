/*! Copyright (c) Epic Systems Corporation 2011 - 2019 */
"undefined"==typeof WP&&(WP={}),void 0===WP.Comm&&(WP.Comm={}),WP.Comm.RESPONSETYPE_COMPLETE=2,WP.Comm.RESPONSETYPE_CONTENTONLY=1,WP.Comm.logOut=function(e,o,t,n,l){o=!0===o,n=!0===n,l=!0===l,!$$WPUtil.IsNullOrEmpty($$WP.Settings.DotNetOnly)&&$$WP.Settings.DotNetOnly||(t=t||"bye.asp"),"function"==typeof e||o||WP.Comm.clearLoggedInStorage();var i,a,m,u=makeLink("Home/LogOut?doRedirect="+(o?"true":"false")+"&logoutPage="+(t||"")+"&isTimeout="+(l?"true":"false"));return n&&"function"==typeof WP.Events.cancelBeforeUnload&&WP.Events.cancelBeforeUnload(),"function"==typeof closeAllWindows&&closeAllWindows(),o?m=function WP$Comm$logout$executeLogout(){WP.Comm.delayKeepAliveForLogout(),window.location=u,"function"==typeof e&&e(),WP.Comm.postLogoutOperations()}:(WP.Comm.logOut.count=0,i="function"!=typeof e?WP.Comm.postLogoutOperations:function WP$Comm$logOut$internalAfterExecute(o){var t,n=o.indexOf('http-equiv="refresh"');n>-1&&(t=o.indexOf("url=",n)+4,"."===(a=o.substring(t,o.indexOf('"',t))).substr(0,1)&&(a=a.substr(2)),a=HTMLUnencode(a)),2==++WP.Comm.logOut.count&&(delete WP.Comm.logOut.count,e(a||"")),WP.Comm.postLogoutOperations()},m=function WP$Comm$logout$executeLogout(){WP.Comm.delayKeepAliveForLogout(),$.ajax({url:u,method:"GET",success:i}),$.ajax({url:makeLink(t),method:"GET",success:i})}),$$WP.IsPendingAJAXRequests?($$WP.PendingAJAXCallBack=m,window.setTimeout((function WP$Comm$logout$failSafeLogout(){null!==$$WP.PendingAJAXCallBack&&"function"==typeof $$WP.PendingAJAXCallBack&&($$WP.PendingAJAXCallBack(),$$WP.PendingAJAXCallBack=null)}),6e3)):m(),!1},WP.Comm.logOut.numExecutions=0,WP.CH5=String.fromCharCode(5),WP.Comm.clearLoggedInStorage=function(){var e=$$WPUtil.isLocalStorageAvailable()&&void 0!==window.localStorage;if(e)var o=localStorage.getItem("OSApptCount"),t=localStorage.getItem("OSApptCountDte"),n=localStorage.getItem("OSScheduledCSNs");WP.Comm.clearStorage(),e&&(localStorage.setItem("OSApptCount",o),localStorage.setItem("OSApptCountDte",t),localStorage.setItem("OSScheduledCSNs",n))},WP.Comm.clearStorage=function(){sessionStorage.clear()},WP.Comm.postLogoutOperations=function(){var e="true"===sessionStorage.IEHyperspaceLaunch;WP.Comm.clearLoggedInStorage(),e&&window.open("","_self").close()},WP.Comm.startKeepAlive=function(){window.setTimeout(WP.Comm.keepAlive,3e4)},WP.Comm.delayKeepAliveForLogout=function(){WP.Comm.keepAlive.delayForLogout=2},WP.Comm.keepAlive=function(){var e=0,keepAliveInternalFun=function(o){"0"===o?logOut(null,!1,!0):2==++e&&WP.Comm.startKeepAlive()};if(-1===window.location.href.indexOf("publicforms.asp")){if(WP.Comm.keepAlive.delayForLogout>0)return--WP.Comm.keepAlive.delayForLogout,void WP.Comm.startKeepAlive();++WP.Comm.keepAlive.counter,"function"==typeof intKeepalive&&intKeepalive(),!$$WPUtil.IsNullOrEmpty($$WP.Settings.DotNetOnly)&&$$WP.Settings.DotNetOnly||$.ajax({url:makeLink("keepalive.asp?cnt="+WP.Comm.keepAlive.counter),success:keepAliveInternalFun,method:"GET",global:!1}),-1===window.location.href.indexOf("termpage.asp")&&-1===window.location.href.indexOf("oeinside.asp")&&$.ajax({url:makeLink("Home/KeepAlive?cnt="+WP.Comm.keepAlive.counter),success:keepAliveInternalFun,method:"GET",global:!1})}},WP.Comm.keepAlive.counter=0,WP.Comm.keepAlive.delayForLogout=0;